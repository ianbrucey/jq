# Translation Automation Process Plan

This document details a hybrid approach for automating the replacement of hardcoded strings with translation keys and generating translation files for the Justice Quest Laravel application. In addition, we include support for Spanish as a secondary language to verify that translations are working correctly.

---

## 1. Automated Parsing & Replacement

### Overview
- **Parse Scan Results:**  
  A script/command will read the JSON output from `storage/app/translation_scan_results.json` generated by the `translations:scan` command. It will iterate over each entry to perform the replacement.

- **File Update Automation:**  
  For each identified string, the process will:
  - **Blade Templates:**  
    Replace plain text with the translation helper syntax, e.g., convert `Case Details` to `{{ __('cases.details') }}` while maintaining HTML integrity.
  - **Alpine.js x-text Directives, PHP, and JavaScript Files:**  
    Update the syntax accordingly to call translation functions without breaking dynamic content or variable interpolations.

- **Dynamic Content Handling:**  
  For strings integrated with variables or complex conditions, flag these cases for manual review instead of automatically modifying them.

---

## 2. Translation File Generation

### Automated Key Assignment
- The `suggested_key` field from the scan results will be used to populate translation files.  
  _Example Entry:_  
  ```json
  {
      "file": "resources/views/cases/show.blade.php",
      "context": "Blade plain text",
      "original": "Case Details",
      "suggested_key": "cases.details"
  }
  ```
  This entry would result in an addition like:
  ```php
  // In lang/en/cases.php
  return [
      'details' => 'Case Details'
  ];
  ```

### File Structure
The translation files will be generated and maintained following these directory structures for both English and Spanish:

```
lang/
├── en/
│   ├── core/
│   ├── cases/
│   └── common/
└── es/
    ├── core/
    ├── cases/
    └── common/
```

### Consistency and Safety Checks
- The automation script will:
  - Verify that existing translation keys are not overwritten.
  - Generate a summary log of all modifications and flag any changes that require manual review.

- **Secondary Language Support (Spanish):**  
  The process will simultaneously update or generate translation files in `lang/es/` with placeholders (or auto-generated initial translations) to ensure that Spanish is immediately supported and can be verified in real scenarios.

---

## 3. Process Flow & Review

### Automated Script Run
1. **Run Scan:**  
   Execute `php artisan translations:scan` to generate the JSON containing all hardcoded strings.

2. **Parse Scan Results:**  
   The automation script reads the JSON file and processes each entry.

3. **Determine Replacement Safety:**  
   For each string:
   - **Safe for Auto-Replacement:**  
     Automatically replace the string in the source file and update corresponding translation files.
   - **Complex/Dynamic Content:**  
     Flag the entry for manual review.

4. **Generate Translation Files:**  
   - Update translation files for both English (`lang/en/`) and Spanish (`lang/es/`).
   - Output a log summarizing all changes along with flagged entries that need manual intervention.

5. **Manual Review:**  
   A task list will be generated for reviewers to manually verify and adjust any flagged translation entries.

6. **Backup & Rollback:**  
   The script will recommend or automatically create backups of modified files before applying changes, ensuring a rollback path if required.

### Mermaid Diagram of Process Flow

```mermaid
graph TD;
    A[Run translations:scan to generate JSON] --> B[Parse JSON scan results];
    B --> C{Is string safe for auto-replacement?};
    C -- Yes --> D[Automatically replace string in source file];
    C -- No --> E[Flag for manual review];
    D --> F[Update corresponding translation files (en & es)];
    E --> F;
    F --> G[Review log and verify changes];
```

---

## Summary

- **Hybrid Approach (Option C):**  
  Automatically replace low-risk strings and generate initial translation files while creating a review task list for complex cases.
  
- **Bilingual Support:**  
  Simultaneously handle English translations and create/update corresponding Spanish translation files in `lang/es/` to ensure the language switching functionality is tested and verified.

- **Safety Measures:**  
  Include backup routines, consistency checks, and a manual review workflow for the highest impact changes.

This structured process will streamline the migration to multilingual support in your Laravel application, ensuring minimal disruption to existing functionality while expanding language support.

---

*End of Plan*